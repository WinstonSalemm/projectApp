# Return Source Selector - Summary

## –ü—Ä–æ–±–ª–µ–º–∞
–ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ "–í–æ–∑–≤—Ä–∞—Ç" –≤ —Å–ø–æ—Å–æ–±–∞—Ö –ø—Ä–æ–¥–∞–∂ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∫—Ä–∞—à–∏–ª–æ—Å—å.

## –†–µ—à–µ–Ω–∏–µ
–°–æ–∑–¥–∞–Ω–∞ –Ω–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ **ReturnSourceSelectorPage** –¥–ª—è –≤—ã–±–æ—Ä–∞ –æ–ø–µ—Ä–∞—Ü–∏–π, –ø–æ –∫–æ—Ç–æ—Ä—ã–º –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –≤–æ–∑–≤—Ä–∞—Ç.

## –ß—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è
‚úÖ **–ü—Ä–æ–¥–∞–∂–∏** (—Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ —Ç–∏–ø—ã):
- –ù–∞–ª —Å —á–µ–∫–æ–º (CashWithReceipt)
- –ù–∞–ª –±–µ–∑ —á–µ–∫–∞ (CashNoReceipt)
- –ö–∞—Ä—Ç–∞ —Å —á–µ–∫–æ–º (CardWithReceipt)
- Click —Å —á–µ–∫–æ–º (ClickWithReceipt)
- Click –±–µ–∑ —á–µ–∫–∞ (ClickNoReceipt)
- –î–æ–≥–æ–≤–æ—Ä (Contract) - –ø—Ä–æ–¥–∞–∂–∏ –ø–æ –¥–æ–≥–æ–≤–æ—Ä—É

‚úÖ **–î–æ–≥–æ–≤–æ—Ä–∞** (Contracts):
- –í—Å–µ –¥–æ–≥–æ–≤–æ—Ä–∞ –≤ —Å–∏—Å—Ç–µ–º–µ

‚ùå **–ù–ï –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è:**
- –ë—Ä–æ–Ω–∏ (Reservation)
- –°–∞–π—Ç (Site)
- Payme

## –§–∞–π–ª—ã —Å–æ–∑–¥–∞–Ω—ã

### Models
- `Models/ReturnSourceItem.cs` - –µ–¥–∏–Ω–∞—è –º–æ–¥–µ–ª—å –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø—Ä–æ–¥–∞–∂ –∏ –¥–æ–≥–æ–≤–æ—Ä–æ–≤

### ViewModels
- `ViewModels/ReturnSourceSelectorViewModel.cs` - –ª–æ–≥–∏–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
  - –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ–¥–∞–∂ —á–µ—Ä–µ–∑ `ApiSalesService`
  - –ó–∞–≥—Ä—É–∑–∫–∞ –¥–æ–≥–æ–≤–æ—Ä–æ–≤ —á–µ—Ä–µ–∑ `ApiContractsService`
  - –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Ç–∏–ø–∞–º –æ–ø–ª–∞—Ç—ã
  - –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –¥–∞—Ç–∞–º
  - –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –¥–∞—Ç–µ (–Ω–æ–≤—ã–µ —Å–≤–µ—Ä—Ö—É)

### Views
- `Views/ReturnSourceSelectorPage.xaml` - UI —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- `Views/ReturnSourceSelectorPage.xaml.cs` - code-behind

### Services
- `Services/ApiContractsService.cs` - –¥–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `GetContractsAsync()`
  - –ó–∞–≥—Ä—É–∂–∞–µ—Ç –¥–æ–≥–æ–≤–æ—Ä–∞ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π –ø–æ –¥–∞—Ç–∞–º (–Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ)
  - –°–¥–µ–ª–∞–Ω `ContractDto` –ø—É–±–ª–∏—á–Ω—ã–º

## –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã

### Dependency Injection
- `MauiProgram.cs` - –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã:
  - `ReturnSourceSelectorViewModel`
  - `ReturnSourceSelectorPage`

### Navigation
- `Views/SaleStartPage.xaml.cs` - –∏–∑–º–µ–Ω–µ–Ω–∞ –Ω–∞–≤–∏–≥–∞—Ü–∏—è:
  - **–ë—ã–ª–æ:** –æ—Ç–∫—Ä—ã–≤–∞–ª–∞—Å—å `SalesHistoryPage`
  - **–°—Ç–∞–ª–æ:** –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è `ReturnSourceSelectorPage`

## UI/UX

### –§–∏–ª—å—Ç—Ä—ã
- –î–∞—Ç—ã "–û—Ç" –∏ "–î–æ" (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: –ø–æ—Å–ª–µ–¥–Ω–∏–µ 31 –¥–µ–Ω—å)
- –ö–Ω–æ–ø–∫–∞ "üîç –ó–∞–≥—Ä—É–∑–∏—Ç—å" –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Ñ–∏–ª—å—Ç—Ä–æ–≤

### –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
–ö–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:
- **–ó–∞–≥–æ–ª–æ–≤–æ–∫:** "–ü—Ä–æ–¥–∞–∂–∞ #123 - 500,000 —Å—É–º" –∏–ª–∏ "–î–æ–≥–æ–≤–æ—Ä #DOG-001 - 1,000,000 —Å—É–º"
- **–ü–æ–¥–∑–∞–≥–æ–ª–æ–≤–æ–∫:** "–ö–ª–∏–µ–Ω—Ç ‚Ä¢ 28.01.2025 14:30"
- **–ë–µ–π–¥–∂:** –¢–∏–ø –æ–ø–ª–∞—Ç—ã ("–ù–∞–ª —Å —á–µ–∫–æ–º", "–ö–∞—Ä—Ç–∞ —Å —á–µ–∫–æ–º", "–î–æ–≥–æ–≤–æ—Ä" –∏ —Ç.–¥.)

### –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ
- **–ù–∞–∂–∞—Ç–∏–µ –Ω–∞ –ø—Ä–æ–¥–∞–∂—É:** –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è `ReturnForSalePage` (—Å—É—â–µ—Å—Ç–≤—É—é—â–∞—è)
- **–ù–∞–∂–∞—Ç–∏–µ –Ω–∞ –¥–æ–≥–æ–≤–æ—Ä:** –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è "–í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ" (TODO)

## –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å

‚úÖ **–ì–æ—Ç–æ–≤–æ:**
- UI —Å—Ç—Ä–∞–Ω–∏—Ü—ã –≤—ã–±–æ—Ä–∞
- –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ–¥–∞–∂
- –ó–∞–≥—Ä—É–∑–∫–∞ –¥–æ–≥–æ–≤–æ—Ä–æ–≤
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Ç–∏–ø–∞–º –æ–ø–ª–∞—Ç—ã
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –¥–∞—Ç–∞–º
- –í–æ–∑–≤—Ä–∞—Ç –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º (—Ä–∞–±–æ—Ç–∞–µ—Ç)

‚ö†Ô∏è **–í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ:**
- –í–æ–∑–≤—Ä–∞—Ç –ø–æ –¥–æ–≥–æ–≤–æ—Ä–∞–º (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è placeholder)

## –ß—Ç–æ –¥–∞–ª—å—à–µ

–ß—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å –≤–æ–∑–≤—Ä–∞—Ç –ø–æ –¥–æ–≥–æ–≤–æ—Ä–∞–º, –Ω—É–∂–Ω–æ:
1. –°–æ–∑–¥–∞—Ç—å backend API –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–æ–≤ –ø–æ –¥–æ–≥–æ–≤–æ—Ä–∞–º (–∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ `/api/returns` –¥–ª—è –ø—Ä–æ–¥–∞–∂)
2. –°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É `ReturnForContractPage` (–∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ `ReturnForSalePage`)
3. –û–±–Ω–æ–≤–∏—Ç—å `ReturnSourceSelectorViewModel.OpenReturnAsync()` –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –Ω–æ–≤–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã

## –ö–∞–∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

1. –û—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
2. –í—ã–±—Ä–∞—Ç—å "–í–æ–∑–≤—Ä–∞—Ç" –≤ —Å–ø–æ—Å–æ–±–∞—Ö –ø—Ä–æ–¥–∞–∂
3. **–î–æ–ª–∂–Ω–∞ –æ—Ç–∫—Ä—ã—Ç—å—Å—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å–æ —Å–ø–∏—Å–∫–æ–º –æ–ø–µ—Ä–∞—Ü–∏–π** (–≤–º–µ—Å—Ç–æ –∫—Ä–∞—à–∞)
4. –ò–∑–º–µ–Ω–∏—Ç—å –¥–∞—Ç—ã –∏ –Ω–∞–∂–∞—Ç—å "–ó–∞–≥—Ä—É–∑–∏—Ç—å"
5. –ù–∞–∂–∞—Ç—å –Ω–∞ –ª—é–±—É—é –ø—Ä–æ–¥–∞–∂—É ‚Üí –æ—Ç–∫—Ä–æ–µ—Ç—Å—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –≤–æ–∑–≤—Ä–∞—Ç–∞
6. –ù–∞–∂–∞—Ç—å –Ω–∞ –¥–æ–≥–æ–≤–æ—Ä ‚Üí –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è "–í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ"

## –õ–æ–≥–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

–í Debug output –±—É–¥—É—Ç –ª–æ–≥–∏:
```
[SaleStartPage] Getting ReturnSourceSelectorPage from DI...
[SaleStartPage] ReturnSourceSelectorPage created successfully
[ReturnSourceSelectorViewModel] LoadAsync START
[ReturnSourceSelectorViewModel] Loading sales...
[ReturnSourceSelectorViewModel] Loading contracts...
[ReturnSourceSelectorViewModel] Loaded N items
```

## –°—Ç–∞—Ç—É—Å: ‚úÖ –ì–û–¢–û–í–û

–ö—Ä–∞—à –∏—Å–ø—Ä–∞–≤–ª–µ–Ω, —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç, –º–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å –≤–æ–∑–≤—Ä–∞—Ç—ã –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º.
