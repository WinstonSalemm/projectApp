# üìù –°–ò–°–¢–ï–ú–ê –î–û–ì–û–í–û–†–û–í - –ö–†–ê–¢–ö–ò–ô –û–ë–ó–û–†

## üéØ –ö–û–ù–¶–ï–ü–¶–ò–Ø:

–î–≤–∞ —Ç–∏–ø–∞ –¥–æ–≥–æ–≤–æ—Ä–æ–≤:

### 1Ô∏è‚É£ **–ó–ê–ö–†–´–¢–´–ô (Closed)**
- –¢–æ–≤–∞—Ä —É–∫–∞–∑–∞–Ω –≤ –æ–ø–∏—Å–∞–Ω–∏–∏, –Ω–æ –µ–≥–æ –ù–ï–¢ –≤ –∫–∞—Ç–∞–ª–æ–≥–µ
- –ü—Ä–∏–º–µ—Ä: "iPhone 15 Pro - –ø—Ä–∏–¥—ë—Ç —á–µ—Ä–µ–∑ –Ω–µ–¥–µ–ª—é"
- –î–æ–≥–æ–≤–æ—Ä —Å–æ–∑–¥–∞–µ—Ç—Å—è —Å—Ä–∞–∑—É, —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ –ù–ï –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç
- –ö–æ–≥–¥–∞ —Ç–æ–≤–∞—Ä –ø–æ—è–≤–∏—Ç—Å—è - –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ –¥–æ–≥–æ–≤–æ—Ä –∏ —Ä–µ–∑–µ—Ä–≤–∏—Ä—É–µ—Ç—Å—è

### 2Ô∏è‚É£ **–û–¢–ö–†–´–¢–´–ô (Open)**
- –£–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –õ–ò–ú–ò–¢ —Å—É–º–º—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä 100 –º–ª–Ω)
- –ö–ª–∏–µ–Ω—Ç –≤—ã–±–∏—Ä–∞–µ—Ç —Ç–æ–≤–∞—Ä—ã –∏–∑ –∫–∞—Ç–∞–ª–æ–≥–∞
- –¢–æ–≤–∞—Ä –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò —Ä–µ–∑–µ—Ä–≤–∏—Ä—É–µ—Ç—Å—è –∏–∑ –ø–∞—Ä—Ç–∏–π (FIFO)
- –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ª–∏–º–∏—Ç–∞

---

## ‚ú® –ö–õ–Æ–ß–ï–í–´–ï –§–ò–ß–ò:

### ‚úÖ –†–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞:
- –ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ —Ç–æ–≤–∞—Ä–∞ –≤ –¥–æ–≥–æ–≤–æ—Ä ‚Üí —Å–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –∏–∑ –ø–∞—Ä—Ç–∏–π (ND-40 –∏–ª–∏ IM-40)
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è FIFO (—Å–Ω–∞—á–∞–ª–∞ —Å—Ç–∞—Ä—ã–µ –ø–∞—Ä—Ç–∏–∏)
- –°–æ–∑–¥–∞—é—Ç—Å—è –∑–∞–ø–∏—Å–∏ –≤ `ContractReservations`

### ‚úÖ –û—Ç–º–µ–Ω–∞ –¥–æ–≥–æ–≤–æ—Ä–∞:
- –¢–æ–≤–∞—Ä –í–û–ó–í–†–ê–©–ê–ï–¢–°–Ø –æ–±—Ä–∞—Ç–Ω–æ –≤ –ø–∞—Ä—Ç–∏–∏
- –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞ —Å–∫–ª–∞–¥–µ
- –í—Å–µ —Ä–µ–∑–µ—Ä–≤—ã –ø–æ–º–µ—á–∞—é—Ç—Å—è –∫–∞–∫ –≤–æ–∑–≤—Ä–∞—â–µ–Ω–Ω—ã–µ

### ‚úÖ –ó–∞–∫—Ä—ã—Ç–∏–µ –¥–æ–≥–æ–≤–æ—Ä–∞:
**–ü—Ä–æ–≤–µ—Ä–∫–∏ –ø–µ—Ä–µ–¥ –∑–∞–∫—Ä—ã—Ç–∏–µ–º:**
1. –ü–æ–ª–Ω–æ—Å—Ç—å—é –æ–ø–ª–∞—á–µ–Ω (PaidAmount = TotalAmount)
2. –ü–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ç–≥—Ä—É–∂–µ–Ω (ShippedAmount = TotalAmount)
3. –í—Å–µ –ø–∞—Ä—Ç–∏–∏ –ø–µ—Ä–µ–≤–µ–¥–µ–Ω—ã –≤ IM-40

–ï—Å–ª–∏ —Ö–æ—Ç—å –æ–¥–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ –ø—Ä–æ–π–¥–µ–Ω–∞ ‚Üí –æ—à–∏–±–∫–∞ —Å –ø–æ–Ω—è—Ç–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º.

---

## üîå API ENDPOINTS:

```
GET    /api/contracts                    - –°–ø–∏—Å–æ–∫ –¥–æ–≥–æ–≤–æ—Ä–æ–≤
GET    /api/contracts/{id}               - –î–µ—Ç–∞–ª–∏ –¥–æ–≥–æ–≤–æ—Ä–∞
POST   /api/contracts                    - –°–æ–∑–¥–∞—Ç—å –¥–æ–≥–æ–≤–æ—Ä
POST   /api/contracts/{id}/items         - –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä
POST   /api/contracts/{id}/payments      - –î–æ–±–∞–≤–∏—Ç—å –æ–ø–ª–∞—Ç—É
POST   /api/contracts/{id}/deliveries    - –û—Ç–≥—Ä—É–∑–∏—Ç—å —Ç–æ–≤–∞—Ä
POST   /api/contracts/{id}/close         - –ó–∞–∫—Ä—ã—Ç—å –¥–æ–≥–æ–≤–æ—Ä
POST   /api/contracts/{id}/cancel        - –û—Ç–º–µ–Ω–∏—Ç—å (–≤–µ—Ä–Ω—É—Ç—å —Ç–æ–≤–∞—Ä)
```

---

## üìä –ú–û–î–ï–õ–ò:

**Contract:**
- Type (Closed/Open)
- ContractNumber
- ClientId
- Description (–¥–ª—è –∑–∞–∫—Ä—ã—Ç—ã—Ö)
- TotalAmount, PaidAmount, ShippedAmount
- Status (Active/Closed/Cancelled)

**ContractItem:**
- ProductId (nullable –¥–ª—è —Ç–æ–≤–∞—Ä–æ–≤ –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç)
- Description (–¥–ª—è –±—É–¥—É—â–∏—Ö —Ç–æ–≤–∞—Ä–æ–≤)
- Qty, UnitPrice
- Status (Reserved/Shipped/Cancelled)

**ContractReservation:**
- ContractItemId
- BatchId (–∏–∑ –∫–∞–∫–æ–π –ø–∞—Ä—Ç–∏–∏ –≤–∑—è–ª–∏)
- ReservedQty
- ReturnedAt (–∫–æ–≥–¥–∞ –≤–µ—Ä–Ω—É–ª–∏)

---

## üé® MAUI UI:

**ContractsPage (–±–∞–∑–æ–≤–∞—è –≤–µ—Ä—Å–∏—è):**
- –°–ø–∏—Å–æ–∫ –¥–æ–≥–æ–≤–æ—Ä–æ–≤ —Å –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–∞–º–∏
- –¶–≤–µ—Ç–Ω—ã–µ —Å—Ç–∞—Ç—É—Å—ã
- –ö–ª–∏–∫ ‚Üí –¥–µ—Ç–∞–ª–∏
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞

**TODO (–ø–æ–ª–Ω–∞—è –≤–µ—Ä—Å–∏—è):**
- –§–æ—Ä–º–∞ —Å–æ–∑–¥–∞–Ω–∏—è –¥–æ–≥–æ–≤–æ—Ä–∞
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤ –∏–∑ –∫–∞—Ç–∞–ª–æ–≥–∞
- –ö–Ω–æ–ø–∫–∏ –æ–ø–ª–∞—Ç—ã/–æ—Ç–≥—Ä—É–∑–∫–∏
- –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

---

## üß™ –ë–´–°–¢–†–´–ô –¢–ï–°–¢:

1. **–°–æ–∑–¥–∞–π –¥–æ–≥–æ–≤–æ—Ä:** POST /api/contracts
2. **–î–æ–±–∞–≤—å —Ç–æ–≤–∞—Ä:** POST /api/contracts/1/items
3. **–ü—Ä–æ–≤–µ—Ä—å —Ä–µ–∑–µ—Ä–≤—ã:** SELECT * FROM ContractReservations
4. **–û—Ç–º–µ–Ω–∏:** POST /api/contracts/1/cancel
5. **–ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ –≤–µ—Ä–Ω—É–ª–æ—Å—å:** SELECT * FROM Batches

---

## üìÅ –§–ê–ô–õ–´:

**Backend:**
- Models/Contract.cs, ContractItem.cs, ContractReservation.cs
- Models/ContractType.cs, ContractItemStatus.cs
- Services/ContractReservationService.cs
- Controllers/ContractsController.cs (–æ–±–Ω–æ–≤–ª–µ–Ω)
- migrations/add-contract-enhancements-v2-mysql.sql

**Frontend:**
- Views/ContractsPage.xaml
- ViewModels/ContractsViewModel.cs
- Services/ApiContractsService.cs (–æ–±–Ω–æ–≤–ª–µ–Ω)

**Docs:**
- CONTRACT_TESTING_GUIDE.md - –ø–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
- CONTRACTS_README.md - —ç—Ç–æ—Ç —Ñ–∞–π–ª

---

## üöÄ –°–¢–ê–¢–£–°: 80% –ì–û–¢–û–í–û

- ‚úÖ Backend API - 100%
- ‚úÖ –†–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ - 100%
- ‚úÖ –û—Ç–º–µ–Ω–∞/–≤–æ–∑–≤—Ä–∞—Ç - 100%
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∏ - 100%
- ‚ö†Ô∏è MAUI UI - 30% (–ø—Ä–æ—Å–º–æ—Ç—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç, —Å–æ–∑–¥–∞–Ω–∏–µ/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–µ—Ç)
