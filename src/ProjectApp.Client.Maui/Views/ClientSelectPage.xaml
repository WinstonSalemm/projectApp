<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="ProjectApp.Client.Maui.Views.ClientSelectPage"
             Title="Ð’Ñ‹Ð±Ð¾Ñ€ ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð°"
             BackgroundColor="{DynamicResource Color.Background}">
  <Grid RowDefinitions="Auto,Auto,*,Auto" Padding="16" RowSpacing="16">
    
    <!-- ÐŸÐ¾Ð¸ÑÐº -->
    <Grid Grid.Row="0" ColumnDefinitions="*,Auto" ColumnSpacing="12">
      <Entry Grid.Column="0" Placeholder="ÐŸÐ¾Ð¸ÑÐº Ð¿Ð¾ Ð¸Ð¼ÐµÐ½Ð¸, Ñ‚ÐµÐ»ÐµÑ„Ð¾Ð½Ñƒ, Ð˜ÐÐ..." Text="{Binding Query}" ReturnCommand="{Binding SearchCommand}" BackgroundColor="{DynamicResource Color.Surface}" TextColor="{DynamicResource Color.Text.Primary}" PlaceholderColor="{DynamicResource Color.Text.Secondary}" HeightRequest="48" FontSize="16"/>
      <Button Grid.Column="1" Text="ÐŸÐ¾Ð¸ÑÐº" Command="{Binding SearchCommand}" WidthRequest="120" HeightRequest="48" FontSize="16"/>
    </Grid>

    <!-- Ð¤Ð¸Ð»ÑŒÑ‚Ñ€ Ð¿Ð¾ Ñ‚Ð¸Ð¿Ñƒ -->
    <HorizontalStackLayout Grid.Row="1" Spacing="12">
      <Border StrokeThickness="0" BackgroundColor="{DynamicResource Color.Primary}" Padding="16,8" StrokeShape="RoundRectangle 20">
        <Border.GestureRecognizers>
          <TapGestureRecognizer Tapped="OnAllTypesClicked"/>
        </Border.GestureRecognizers>
        <Label Text="Ð’ÑÐµ" TextColor="White" FontSize="14" FontAttributes="Bold"/>
      </Border>
      
      <Border StrokeThickness="0" BackgroundColor="{DynamicResource Color.Primary}" Padding="16,8" StrokeShape="RoundRectangle 20">
        <Border.GestureRecognizers>
          <TapGestureRecognizer Tapped="OnLegalClicked"/>
        </Border.GestureRecognizers>
        <Label Text="Ð®Ñ€.Ð»Ð¸Ñ†Ð°" TextColor="White" FontSize="14" FontAttributes="Bold"/>
      </Border>
      
      <Border StrokeThickness="0" BackgroundColor="{DynamicResource Color.Primary}" Padding="16,8" StrokeShape="RoundRectangle 20">
        <Border.GestureRecognizers>
          <TapGestureRecognizer Tapped="OnIndividualClicked"/>
        </Border.GestureRecognizers>
        <Label Text="Ð¤Ð¸Ð·.Ð»Ð¸Ñ†Ð°" TextColor="White" FontSize="14" FontAttributes="Bold"/>
      </Border>
    </HorizontalStackLayout>

    <!-- Ð¡Ð¿Ð¸ÑÐ¾Ðº ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð¾Ð² -->
    <ScrollView Grid.Row="2">
      <VerticalStackLayout BindableLayout.ItemsSource="{Binding Clients}" Spacing="12">
        <BindableLayout.EmptyView>
          <VerticalStackLayout Padding="32" Spacing="12" HorizontalOptions="Center" VerticalOptions="Center">
            <Label Text="ðŸ‘¥" FontSize="48" HorizontalTextAlignment="Center"/>
            <Label Text="ÐšÐ»Ð¸ÐµÐ½Ñ‚Ñ‹ Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½Ñ‹" FontSize="18" FontAttributes="Bold" HorizontalTextAlignment="Center"/>
            <Label Text="Ð”Ð¾Ð±Ð°Ð²ÑŒÑ‚Ðµ Ð¿ÐµÑ€Ð²Ð¾Ð³Ð¾ ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð°" FontSize="14" TextColor="{DynamicResource Color.Text.Secondary}" HorizontalTextAlignment="Center"/>
          </VerticalStackLayout>
        </BindableLayout.EmptyView>
        <BindableLayout.ItemTemplate>
          <DataTemplate>
            <Border StrokeThickness="1" Stroke="{DynamicResource Color.Border}" BackgroundColor="{DynamicResource Color.Surface}" Padding="16" StrokeShape="RoundRectangle 8">
              <Border.GestureRecognizers>
                <TapGestureRecognizer CommandParameter="{Binding .}" Tapped="OnClientSelected"/>
              </Border.GestureRecognizers>
              <Grid RowDefinitions="Auto,Auto,Auto" RowSpacing="8">
                <!-- Ð˜Ð¼Ñ Ð¸ Ñ‚Ð¸Ð¿ -->
                <Grid Grid.Row="0" ColumnDefinitions="*,Auto" ColumnSpacing="12">
                  <Label Grid.Column="0" Text="{Binding Name}" FontSize="18" FontAttributes="Bold"/>
                  <Border Grid.Column="1" StrokeThickness="0" BackgroundColor="{DynamicResource Color.Primary}" Padding="8,4" StrokeShape="RoundRectangle 4">
                    <Label Text="{Binding TypeLabel}" TextColor="White" FontSize="11" FontAttributes="Bold"/>
                  </Border>
                </Grid>
                
                <!-- Ð¢ÐµÐ»ÐµÑ„Ð¾Ð½ -->
                <Label Grid.Row="1" Text="{Binding Phone}" FontSize="14" TextColor="{DynamicResource Color.Text.Secondary}"/>
                
                <!-- Ð˜ÐÐ (ÐµÑÐ»Ð¸ ÐµÑÑ‚ÑŒ) -->
                <Label Grid.Row="2" Text="{Binding Inn}" FontSize="13" TextColor="{DynamicResource Color.Text.Secondary}" IsVisible="{Binding HasInn}"/>
              </Grid>
            </Border>
          </DataTemplate>
        </BindableLayout.ItemTemplate>
      </VerticalStackLayout>
    </ScrollView>

    <!-- ÐšÐ½Ð¾Ð¿ÐºÐ¸ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ð¹ -->
    <Grid Grid.Row="3" ColumnDefinitions="*,*" ColumnSpacing="12">
      <Button Grid.Column="0" Text="âž• Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð°" Command="{Binding AddClientCommand}" HeightRequest="48" FontSize="16" FontAttributes="Bold"/>
      <Button Grid.Column="1" Text="âŒ Ð‘ÐµÐ· ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð°" Clicked="OnSkipClient" HeightRequest="48" FontSize="16" FontAttributes="Bold" BackgroundColor="{DynamicResource Color.Text.Secondary}"/>
    </Grid>
  </Grid>
</ContentPage>
