<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:viewModels="clr-namespace:ProjectApp.Client.Maui.ViewModels"
             x:Class="ProjectApp.Client.Maui.Views.ProductSelectPage"
             x:Name="Root"
             Title="Р’С‹Р±РѕСЂ С‚РѕРІР°СЂР°">
  <ContentPage.Content>
    <Grid Padding="12" RowDefinitions="Auto,*" RowSpacing="12">
      <Grid Grid.Row="0" ColumnDefinitions="*,Auto,200,Auto,Auto" ColumnSpacing="8">
        <Entry Grid.Column="0" Placeholder="РџРѕРёСЃРє (SKU РёР»Рё РЅР°Р·РІР°РЅРёРµ)" Text="{Binding Query}"/>
        <Label Grid.Column="1" Text="РљР°С‚РµРіРѕСЂРёСЏ:" VerticalTextAlignment="Center"/>
        <Picker Grid.Column="2" ItemsSource="{Binding Categories}" SelectedItem="{Binding SelectedCategory}"/>
        <Button Grid.Column="3" Text="РСЃРєР°С‚СЊ" Command="{Binding SearchAsyncCommand}" ImageSource="{StaticResource IconRefresh}" ContentLayout="Left,8"/>
        <Button Grid.Column="4" Text="РќРѕРІС‹Р№ С‚РѕРІР°СЂ" Clicked="OnCreateClicked" Style="{StaticResource OutlinedButton}"/>
      </Grid>

      <CollectionView Grid.Row="1" ItemsSource="{Binding Results}" SelectionMode="Single" SelectionChanged="OnSelectionChanged">
        <CollectionView.ItemTemplate>
          <DataTemplate>
            <Grid ColumnDefinitions="*,Auto,Auto,Auto,Auto" Padding="8" ColumnSpacing="12">
              <VerticalStackLayout>
                <Label Text="{Binding Name}" FontAttributes="Bold"/>
                <Label Text="{Binding Sku}" FontSize="12" TextColor="Gray"/>
                <Label Text="{Binding Price, Converter={StaticResource CurrencyConverter}, StringFormat='Р РµРєРѕРјРµРЅРґ.: {0}'}" FontSize="12"/>
              </VerticalStackLayout>
              <Label Grid.Column="1" Text="{Binding Nd40Qty, StringFormat='ND-40: {0:N0}'}" VerticalTextAlignment="Center"/>
              <Label Grid.Column="2" Text="{Binding Im40Qty, StringFormat='IM-40: {0:N0}'}" VerticalTextAlignment="Center"/>
              <Label Grid.Column="3" Text="{Binding TotalQty, StringFormat='Р’СЃРµРіРѕ: {0:N0}'}" VerticalTextAlignment="Center"/>
              <Button Grid.Column="4" Text="Р’С‹Р±СЂР°С‚СЊ" CommandParameter="{Binding .}" Clicked="OnPickClicked"/>
            </Grid>
          </DataTemplate>
        </CollectionView.ItemTemplate>
        <CollectionView.EmptyView>
          <VerticalStackLayout Padding="12" Spacing="6">
            <Label Text="РўРѕРІР°СЂС‹ РЅРµ РЅР°Р№РґРµРЅС‹" FontAttributes="Bold" TextColor="{StaticResource MutedTextColor}"/>
            <Label Text="РР·РјРµРЅРёС‚Рµ Р·Р°РїСЂРѕСЃ/РєР°С‚РµРіРѕСЂРёСЋ Рё РїРѕРІС‚РѕСЂРёС‚Рµ РїРѕРёСЃРє" FontSize="12" TextColor="{StaticResource MutedTextColor}"/>
          </VerticalStackLayout>
        </CollectionView.EmptyView>
      </CollectionView>
    </Grid>
  </ContentPage.Content>
</ContentPage>


