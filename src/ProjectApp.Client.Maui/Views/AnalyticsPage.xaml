<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="ProjectApp.Client.Maui.Views.AnalyticsPage"
             Title="ÐÐ½Ð°Ð»Ð¸Ñ‚Ð¸ÐºÐ°"
             BackgroundColor="{DynamicResource Color.Background}">
  
  <Grid RowDefinitions="Auto,*" Padding="0">
    <!-- Ð¢Ð°Ð±Ñ‹ -->
    <HorizontalStackLayout Grid.Row="0" Spacing="0" BackgroundColor="{DynamicResource Color.Surface}">
      <Border x:Name="TabFinance" Padding="20,16" BackgroundColor="{DynamicResource Color.Primary}">
        <Border.GestureRecognizers>
          <TapGestureRecognizer Tapped="OnFinanceTabTapped"/>
        </Border.GestureRecognizers>
        <Label Text="Ð¤Ð¸Ð½Ð°Ð½ÑÑ‹" TextColor="White" FontSize="16" FontAttributes="Bold"/>
      </Border>
      
      <Border x:Name="TabManagers" Padding="20,16" BackgroundColor="Transparent">
        <Border.GestureRecognizers>
          <TapGestureRecognizer Tapped="OnManagersTabTapped"/>
        </Border.GestureRecognizers>
        <Label Text="ÐœÐµÐ½ÐµÐ´Ð¶ÐµÑ€Ñ‹" TextColor="{DynamicResource Color.Text.Primary}" FontSize="16"/>
      </Border>
    </HorizontalStackLayout>

    <!-- ÐšÐ¾Ð½Ñ‚ÐµÐ½Ñ‚ -->
    <Grid Grid.Row="1" x:Name="ContentArea">
      <!-- Finance Tab Content -->
      <ScrollView x:Name="FinanceContent" IsVisible="True" Padding="16">
        <VerticalStackLayout Spacing="16">
          <Label Text="ðŸ“Š Ð¤Ð¸Ð½Ð°Ð½ÑÐ¾Ð²Ð°Ñ Ð°Ð½Ð°Ð»Ð¸Ñ‚Ð¸ÐºÐ°" FontSize="24" FontAttributes="Bold"/>
          <Label Text="Ð Ð°Ð·Ð´ÐµÐ» Ð² Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐµ..." FontSize="16" TextColor="{DynamicResource Color.Text.Secondary}"/>
        </VerticalStackLayout>
      </ScrollView>

      <!-- Managers Tab Content -->
      <ScrollView x:Name="ManagersContent" IsVisible="False" Padding="16">
        <VerticalStackLayout Spacing="16" BindableLayout.ItemsSource="{Binding ManagerStats}">
          <Label Text="ðŸ‘¥ ÐÐ½Ð°Ð»Ð¸Ñ‚Ð¸ÐºÐ° Ð¿Ð¾ Ð¼ÐµÐ½ÐµÐ´Ð¶ÐµÑ€Ð°Ð¼" FontSize="24" FontAttributes="Bold" Margin="0,0,0,16"/>
          
          <BindableLayout.EmptyView>
            <VerticalStackLayout Padding="32" Spacing="12" HorizontalOptions="Center">
              <Label Text="ðŸ“Š" FontSize="48" HorizontalTextAlignment="Center"/>
              <Label Text="Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° ÑÑ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ¸..." FontSize="16" TextColor="{DynamicResource Color.Text.Secondary}" HorizontalTextAlignment="Center"/>
            </VerticalStackLayout>
          </BindableLayout.EmptyView>
          
          <BindableLayout.ItemTemplate>
            <DataTemplate>
              <Border StrokeThickness="1" Stroke="{DynamicResource Color.Border}" BackgroundColor="{DynamicResource Color.Surface}" Padding="16" Margin="0,0,0,12" StrokeShape="RoundRectangle 12">
                <Grid RowDefinitions="Auto,Auto,Auto,Auto,Auto" RowSpacing="12">
                  <!-- Ð˜Ð¼Ñ Ð¼ÐµÐ½ÐµÐ´Ð¶ÐµÑ€Ð° -->
                  <Label Grid.Row="0" Text="{Binding ManagerName}" FontSize="20" FontAttributes="Bold"/>
                  
                  <!-- ÐžÐ±Ñ‰Ð¸Ð¹ Ð¾Ð±Ð¾Ñ€Ð¾Ñ‚ -->
                  <Grid Grid.Row="1" ColumnDefinitions="Auto,*" ColumnSpacing="8">
                    <Label Grid.Column="0" Text="ðŸ’° ÐžÐ±Ñ‰Ð¸Ð¹ Ð¾Ð±Ð¾Ñ€Ð¾Ñ‚:" FontSize="14" TextColor="{DynamicResource Color.Text.Secondary}"/>
                    <Label Grid.Column="1" Text="{Binding TotalRevenue, StringFormat='{0:N0} ÑÑƒÐ¼'}" FontSize="14" FontAttributes="Bold"/>
                  </Grid>
                  
                  <!-- ÐžÐ±Ð¾Ñ€Ð¾Ñ‚ ÑÐ²Ð¾Ð¸Ð¼ ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð°Ð¼ -->
                  <Grid Grid.Row="2" ColumnDefinitions="Auto,*" ColumnSpacing="8">
                    <Label Grid.Column="0" Text="âœ… ÐžÐ±Ð¾Ñ€Ð¾Ñ‚ ÑÐ²Ð¾Ð¸Ð¼ ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð°Ð¼:" FontSize="14" TextColor="{DynamicResource Color.Text.Secondary}"/>
                    <Label Grid.Column="1" Text="{Binding OwnClientsRevenue, StringFormat='{0:N0} ÑÑƒÐ¼'}" FontSize="14" FontAttributes="Bold" TextColor="{DynamicResource Color.Success}"/>
                  </Grid>
                  
                  <!-- ÐŸÑ€Ð¾Ñ†ÐµÐ½Ñ‚ Ð¾Ñ‚ ÑÐ²Ð¾Ð¸Ñ… -->
                  <Grid Grid.Row="3" ColumnDefinitions="Auto,*" ColumnSpacing="8">
                    <Label Grid.Column="0" Text="ðŸ“ˆ Ð”Ð¾Ð»Ñ ÑÐ²Ð¾Ð¸Ñ… ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð¾Ð²:" FontSize="14" TextColor="{DynamicResource Color.Text.Secondary}"/>
                    <Label Grid.Column="1" Text="{Binding OwnClientsPercentage, StringFormat='{0:F1}%'}" FontSize="14" FontAttributes="Bold" TextColor="{DynamicResource Color.Primary}"/>
                  </Grid>
                  
                  <!-- ÐšÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð¾Ð² -->
                  <Grid Grid.Row="4" ColumnDefinitions="Auto,*" ColumnSpacing="8">
                    <Label Grid.Column="0" Text="ðŸ‘¤ ÐŸÑ€Ð¸Ð²ÐµÐ´ÐµÐ½Ð½Ñ‹Ñ… ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð¾Ð²:" FontSize="14" TextColor="{DynamicResource Color.Text.Secondary}"/>
                    <Label Grid.Column="1" Text="{Binding ClientsCount}" FontSize="14" FontAttributes="Bold"/>
                  </Grid>
                </Grid>
              </Border>
            </DataTemplate>
          </BindableLayout.ItemTemplate>
        </VerticalStackLayout>
      </ScrollView>
    </Grid>
  </Grid>
</ContentPage>
