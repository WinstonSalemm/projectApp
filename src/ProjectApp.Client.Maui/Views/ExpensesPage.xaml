<?xml version="1.0" encoding="utf-8"?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:ProjectApp.Client.Maui.ViewModels"
             x:Class="ProjectApp.Client.Maui.Views.ExpensesPage"
             Title="Ð Ð°ÑÑ…Ð¾Ð´Ñ‹"
             BackgroundColor="{DynamicResource Color.Background}">
  
  <Grid RowDefinitions="Auto,*" Padding="16">
    
    <!-- Header with Statistics -->
    <VerticalStackLayout Spacing="8">
      <Label Text="ðŸ“Š ÐžÐ¿ÐµÑ€Ð°Ñ†Ð¸Ð¾Ð½Ð½Ñ‹Ðµ Ñ€Ð°ÑÑ…Ð¾Ð´Ñ‹" 
             FontSize="24" 
             FontAttributes="Bold"
             TextColor="{DynamicResource Color.Text.Primary}" />
      
      <Grid ColumnDefinitions="*,*" ColumnSpacing="8" Margin="0,8,0,0">
        <Frame Grid.Column="0" Padding="12" Style="{StaticResource Card}">
          <VerticalStackLayout Spacing="4">
            <Label Text="Ð’Ð¡Ð•Ð“Ðž Ð ÐÐ¡Ð¥ÐžÐ”ÐžÐ’" FontSize="10" TextColor="{DynamicResource Color.Text.Secondary}" />
            <Label Text="{Binding TotalCount}" FontSize="24" FontAttributes="Bold" TextColor="{DynamicResource Color.Primary}" />
          </VerticalStackLayout>
        </Frame>
        <Frame Grid.Column="1" Padding="12" Style="{StaticResource Card}">
          <VerticalStackLayout Spacing="4">
            <Label Text="Ð¡Ð£ÐœÐœÐ" FontSize="10" TextColor="{DynamicResource Color.Text.Secondary}" />
            <Label Text="{Binding TotalAmount, StringFormat='{0:N0} ÑÑƒÐ¼'}" FontSize="20" FontAttributes="Bold" TextColor="{DynamicResource Color.Primary}" />
          </VerticalStackLayout>
        </Frame>
      </Grid>
    </VerticalStackLayout>

    <!-- Expenses List -->
    <ScrollView Grid.Row="1" VerticalScrollBarVisibility="Always">
      <CollectionView ItemsSource="{Binding Expenses}" Margin="0,0,12,0">
        <CollectionView.ItemTemplate>
          <DataTemplate>
            <Frame Padding="16" Margin="0,8,0,0" Style="{StaticResource CardFrame}">
              <Grid ColumnDefinitions="Auto,*,Auto" RowDefinitions="Auto,Auto,Auto">
                
                <Label Grid.Column="0" Grid.RowSpan="3" Text="{Binding Icon, FallbackValue='ðŸ’°'}" FontSize="32" VerticalOptions="Center" Margin="0,0,12,0" />
                
                <Label Grid.Column="1" Text="{Binding Type}" FontSize="16" FontAttributes="Bold" TextColor="{DynamicResource Color.Text.Primary}" />
                
                <Frame Grid.Column="2" Grid.RowSpan="2" Padding="8,4" CornerRadius="12" BackgroundColor="{Binding StatusColor}" HasShadow="False">
                  <Label Text="{Binding Status}" FontSize="12" TextColor="White" />
                </Frame>
                
                <Label Grid.Column="1" Grid.Row="1" Text="{Binding Description}" FontSize="12" TextColor="{DynamicResource Color.Text.Secondary}" />
                
                <Grid Grid.Column="1" Grid.Row="2" ColumnDefinitions="*,Auto" Margin="0,4,0,0">
                  <Label Text="{Binding ExpenseDate, StringFormat='{0:dd.MM.yyyy}'}" FontSize="12" TextColor="{DynamicResource Color.Text.Tertiary}" />
                  <Label Grid.Column="1" Text="{Binding Amount, StringFormat='{0:N0} ÑÑƒÐ¼'}" FontSize="16" FontAttributes="Bold" TextColor="{DynamicResource Color.Primary}" />
                </Grid>
                
              </Grid>
            </Frame>
          </DataTemplate>
        </CollectionView.ItemTemplate>
      </CollectionView>
    </ScrollView>
    
    <ActivityIndicator Grid.Row="1" IsRunning="{Binding IsBusy}" IsVisible="{Binding IsBusy}" Color="{DynamicResource Color.Primary}" HorizontalOptions="Center" VerticalOptions="Center" />
    
  </Grid>
  
</ContentPage>
