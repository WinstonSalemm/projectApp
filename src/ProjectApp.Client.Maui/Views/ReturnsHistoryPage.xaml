<?xml version="1.0" encoding="utf-8"?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="ProjectApp.Client.Maui.Views.ReturnsHistoryPage"
             Title="Возвраты">
  <Grid Padding="16" RowDefinitions="Auto,*" RowSpacing="12">
    <Grid Grid.Row="0" ColumnDefinitions="*,*,Auto" ColumnSpacing="8">
      <HorizontalStackLayout Grid.Column="0" Spacing="8">
        <Label Text="От:" VerticalTextAlignment="Center"/>
        <DatePicker Date="{Binding DateFrom}"/>
      </HorizontalStackLayout>
      <HorizontalStackLayout Grid.Column="1" Spacing="8">
        <Label Text="До:" VerticalTextAlignment="Center"/>
        <DatePicker Date="{Binding DateTo}"/>
      </HorizontalStackLayout>
      <Button Grid.Column="2" Text="Обновить" Command="{Binding LoadCommand}" ImageSource="{StaticResource IconRefresh}" ContentLayout="Left,8"/>
    </Grid>

    <CollectionView Grid.Row="1" ItemsSource="{Binding Items}">
      <CollectionView.ItemTemplate>
        <DataTemplate>
          <Frame Padding="10" HasShadow="False" CornerRadius="10">
            <VerticalStackLayout Spacing="6">
              <Label Text="{Binding Id, StringFormat='Возврат #{0}'}" FontAttributes="Bold"/>
              <Label Text="{Binding CreatedAt, Converter={StaticResource DateTimeToRuConverter}}" FontSize="12" TextColor="Gray"/>
              <Label Text="{Binding RefSaleId, StringFormat='Продажа: #{0}'}"/>
              <Label Text="{Binding Sum, Converter={StaticResource CurrencyConverter}, StringFormat='Сумма: {0}'}"/>
              <Label Text="{Binding Reason}" FontSize="12"/>
            </VerticalStackLayout>
          </Frame>
        </DataTemplate>
      </CollectionView.ItemTemplate>
      <CollectionView.EmptyView>
        <VerticalStackLayout Padding="12" Spacing="6">
          <Label Text="Нет возвратов" FontAttributes="Bold" TextColor="{StaticResource MutedTextColor}"/>
          <Label Text="Выберите даты и нажмите обновить" FontSize="12" TextColor="{StaticResource MutedTextColor}"/>
        </VerticalStackLayout>
      </CollectionView.EmptyView>
    </CollectionView>
  </Grid>
</ContentPage>
