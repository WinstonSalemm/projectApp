<?xml version="1.0" encoding="utf-8"?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:ProjectApp.Client.Maui.ViewModels"
             x:Class="ProjectApp.Client.Maui.Views.TaxAnalyticsPage"
             x:DataType="vm:TaxAnalyticsViewModel"
             Title="ÐÐ°Ð»Ð¾Ð³Ð¾Ð²Ð°Ñ Ð°Ð½Ð°Ð»Ð¸Ñ‚Ð¸ÐºÐ°"
             BackgroundColor="{DynamicResource Color.Background}">
  
  <ScrollView VerticalScrollBarVisibility="Always">
    <VerticalStackLayout Padding="16" Spacing="16">
      
      <Label Text="ðŸ“ˆ ÐÐ°Ð»Ð¾Ð³Ð¾Ð²Ð°Ñ Ð°Ð½Ð°Ð»Ð¸Ñ‚Ð¸ÐºÐ° Ð£Ð—" FontSize="24" FontAttributes="Bold" />
      <Label Text="{Binding PeriodText}" FontSize="16" TextColor="{DynamicResource Color.Text.Secondary}" />
      
      <!-- Revenue Section -->
      <Label Text="Ð’Ð«Ð Ð£Ð§ÐšÐ" FontSize="14" FontAttributes="Bold" TextColor="{DynamicResource Color.Text.Secondary}" Margin="0,16,0,0" />
      <Frame Padding="16" Style="{StaticResource Card}">
        <Grid ColumnDefinitions="*,Auto" RowDefinitions="Auto,Auto">
          <Label Text="Ð’Ñ‹Ñ€ÑƒÑ‡ÐºÐ° Ñ ÐÐ”Ð¡" FontSize="14" />
          <Label Grid.Column="1" Text="{Binding TotalRevenue, StringFormat='{0:N0} ÑÑƒÐ¼'}" FontSize="16" FontAttributes="Bold" TextColor="{DynamicResource Color.Primary}" />
          <Label Grid.Row="1" Text="Ð‘ÐµÐ· ÐÐ”Ð¡ (12%)" FontSize="12" TextColor="{DynamicResource Color.Text.Secondary}" />
          <Label Grid.Row="1" Grid.Column="1" Text="{Binding RevenueWithoutVAT, StringFormat='{0:N0} ÑÑƒÐ¼'}" FontSize="14" TextColor="{DynamicResource Color.Primary}" />
        </Grid>
      </Frame>
      
      <!-- VAT Section -->
      <Label Text="ÐÐ”Ð¡" FontSize="14" FontAttributes="Bold" TextColor="{DynamicResource Color.Text.Secondary}" Margin="0,8,0,0" />
      <Grid ColumnDefinitions="*,*" ColumnSpacing="8">
        <Frame Padding="12" Style="{StaticResource Card}">
          <VerticalStackLayout Spacing="4">
            <Label Text="ÐÐ”Ð¡ Ñ Ð¿Ñ€Ð¾Ð´Ð°Ð¶" FontSize="12" />
            <Label Text="{Binding VatFromSales, StringFormat='{0:N0}'}" FontSize="18" FontAttributes="Bold" TextColor="{DynamicResource Color.Primary}" />
          </VerticalStackLayout>
        </Frame>
        <Frame Grid.Column="1" Padding="12" Style="{StaticResource Card}">
          <VerticalStackLayout Spacing="4">
            <Label Text="ÐÐ”Ð¡ Ðº ÑƒÐ¿Ð»Ð°Ñ‚Ðµ" FontSize="12" />
            <Label Text="{Binding VatPayable, StringFormat='{0:N0}'}" FontSize="18" FontAttributes="Bold" TextColor="{DynamicResource Color.Primary}" />
          </VerticalStackLayout>
        </Frame>
      </Grid>
      
      <!-- Other Taxes -->
      <Label Text="Ð”Ð Ð£Ð“Ð˜Ð• ÐÐÐ›ÐžÐ“Ð˜" FontSize="14" FontAttributes="Bold" TextColor="{DynamicResource Color.Text.Secondary}" Margin="0,8,0,0" />
      <Frame Padding="16" Style="{StaticResource Card}">
        <VerticalStackLayout Spacing="12">
          <Grid ColumnDefinitions="*,Auto">
            <Label Text="ðŸ’¼ ÐÐ°Ð»Ð¾Ð³ Ð½Ð° Ð¿Ñ€Ð¸Ð±Ñ‹Ð»ÑŒ (15%)" FontSize="14" />
            <Label Grid.Column="1" Text="{Binding IncomeTax, StringFormat='{0:N0} ÑÑƒÐ¼'}" FontSize="16" FontAttributes="Bold" />
          </Grid>
          <BoxView HeightRequest="1" BackgroundColor="{DynamicResource Color.Border}" />
          <Grid ColumnDefinitions="*,Auto">
            <Label Text="ðŸ‘¥ Ð¡Ð¾Ñ†Ð¸Ð°Ð»ÑŒÐ½Ñ‹Ðµ Ð½Ð°Ð»Ð¾Ð³Ð¸ (Ð•Ð¡ÐŸ+Ð˜ÐÐŸÐ¡+Ð¨ÐºÐ¾Ð»ÑŒÐ½Ñ‹Ð¹)" FontSize="14" />
            <Label Grid.Column="1" Text="{Binding SocialTax, StringFormat='{0:N0} ÑÑƒÐ¼'}" FontSize="16" FontAttributes="Bold" />
          </Grid>
        </VerticalStackLayout>
      </Frame>
      
      <!-- Total Section -->
      <Label Text="Ð˜Ð¢ÐžÐ“Ðž" FontSize="14" FontAttributes="Bold" TextColor="{DynamicResource Color.Text.Secondary}" Margin="0,8,0,0" />
      <Frame Padding="16" Style="{StaticResource Card}">
        <Grid ColumnDefinitions="*,Auto" RowDefinitions="Auto,Auto,Auto">
          <Label Text="Ð’ÑÐµÐ³Ð¾ Ð½Ð°Ð»Ð¾Ð³Ð¾Ð²" FontSize="16" FontAttributes="Bold" />
          <Label Grid.Column="1" Text="{Binding TotalTaxes, StringFormat='{0:N0} ÑÑƒÐ¼'}" FontSize="20" FontAttributes="Bold" TextColor="{DynamicResource Color.Primary}" />
          
          <BoxView Grid.Row="1" Grid.ColumnSpan="2" HeightRequest="1" BackgroundColor="{DynamicResource Color.Border}" Margin="0,12" />
          
          <Label Grid.Row="2" Text="Ð§Ð¸ÑÑ‚Ð°Ñ Ð¿Ñ€Ð¸Ð±Ñ‹Ð»ÑŒ" FontSize="16" FontAttributes="Bold" />
          <Label Grid.Row="2" Grid.Column="1" Text="{Binding NetProfit, StringFormat='{0:N0} ÑÑƒÐ¼'}" FontSize="20" FontAttributes="Bold" TextColor="{DynamicResource Color.Primary}" />
        </Grid>
      </Frame>
      
      <Frame Padding="12" Style="{StaticResource Card}">
        <HorizontalStackLayout Spacing="8" HorizontalOptions="Center">
          <Label Text="ðŸ“Š Ð ÐµÐ½Ñ‚Ð°Ð±ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚ÑŒ:" FontSize="14" />
          <Label Text="{Binding NetProfitMargin, StringFormat='{0:F2}%'}" FontSize="18" FontAttributes="Bold" TextColor="{DynamicResource Color.Primary}" />
        </HorizontalStackLayout>
      </Frame>
      
      <ActivityIndicator IsRunning="{Binding IsBusy}" IsVisible="{Binding IsBusy}" HorizontalOptions="Center" Margin="0,20,0,0" Color="{DynamicResource Color.Primary}" />
      
    </VerticalStackLayout>
  </ScrollView>
  
</ContentPage>
