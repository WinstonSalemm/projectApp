<?xml version="1.0" encoding="utf-8"?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:ProjectApp.Client.Maui.ViewModels"
             x:Class="ProjectApp.Client.Maui.Views.TaxAnalyticsPage"
             x:DataType="vm:TaxAnalyticsViewModel"
             Title="Налоговая аналитика">
  
  <ScrollView>
    <VerticalStackLayout Padding="16" Spacing="16">
      
      <Label Text="📈 Налоговая аналитика УЗ" FontSize="24" FontAttributes="Bold" />
      <Label Text="{Binding PeriodText}" FontSize="16" TextColor="Gray" />
      
      <!-- Revenue Section -->
      <Label Text="ВЫРУЧКА" FontSize="14" FontAttributes="Bold" TextColor="Gray" Margin="0,16,0,0" />
      <Frame Padding="16" CornerRadius="8" BackgroundColor="#E3F2FD">
        <Grid ColumnDefinitions="*,Auto" RowDefinitions="Auto,Auto">
          <Label Text="Выручка с НДС" FontSize="14" />
          <Label Grid.Column="1" Text="{Binding TotalRevenue, StringFormat='{0:N0} сум'}" FontSize="16" FontAttributes="Bold" TextColor="#1976D2" />
          <Label Grid.Row="1" Text="Без НДС (12%)" FontSize="12" TextColor="Gray" />
          <Label Grid.Row="1" Grid.Column="1" Text="{Binding RevenueWithoutVAT, StringFormat='{0:N0} сум'}" FontSize="14" TextColor="#1976D2" />
        </Grid>
      </Frame>
      
      <!-- VAT Section -->
      <Label Text="НДС" FontSize="14" FontAttributes="Bold" TextColor="Gray" Margin="0,8,0,0" />
      <Grid ColumnDefinitions="*,*" ColumnSpacing="8">
        <Frame Padding="12" CornerRadius="8" BackgroundColor="#FFF3E0">
          <VerticalStackLayout Spacing="4">
            <Label Text="НДС с продаж" FontSize="12" />
            <Label Text="{Binding VatFromSales, StringFormat='{0:N0}'}" FontSize="18" FontAttributes="Bold" TextColor="#FF9800" />
          </VerticalStackLayout>
        </Frame>
        <Frame Grid.Column="1" Padding="12" CornerRadius="8" BackgroundColor="#FFEBEE">
          <VerticalStackLayout Spacing="4">
            <Label Text="НДС к уплате" FontSize="12" />
            <Label Text="{Binding VatPayable, StringFormat='{0:N0}'}" FontSize="18" FontAttributes="Bold" TextColor="#F44336" />
          </VerticalStackLayout>
        </Frame>
      </Grid>
      
      <!-- Other Taxes -->
      <Label Text="ДРУГИЕ НАЛОГИ" FontSize="14" FontAttributes="Bold" TextColor="Gray" Margin="0,8,0,0" />
      <Frame Padding="16" CornerRadius="8" BackgroundColor="White" HasShadow="True">
        <VerticalStackLayout Spacing="12">
          <Grid ColumnDefinitions="*,Auto">
            <Label Text="💼 Налог на прибыль (15%)" FontSize="14" />
            <Label Grid.Column="1" Text="{Binding IncomeTax, StringFormat='{0:N0} сум'}" FontSize="16" FontAttributes="Bold" />
          </Grid>
          <BoxView HeightRequest="1" BackgroundColor="#E0E0E0" />
          <Grid ColumnDefinitions="*,Auto">
            <Label Text="👥 Социальные налоги (ЕСП+ИНПС+Школьный)" FontSize="14" />
            <Label Grid.Column="1" Text="{Binding SocialTax, StringFormat='{0:N0} сум'}" FontSize="16" FontAttributes="Bold" />
          </Grid>
        </VerticalStackLayout>
      </Frame>
      
      <!-- Total Section -->
      <Label Text="ИТОГО" FontSize="14" FontAttributes="Bold" TextColor="Gray" Margin="0,8,0,0" />
      <Frame Padding="16" CornerRadius="8" BackgroundColor="#FFEBEE" HasShadow="True">
        <Grid ColumnDefinitions="*,Auto" RowDefinitions="Auto,Auto,Auto">
          <Label Text="Всего налогов" FontSize="16" FontAttributes="Bold" />
          <Label Grid.Column="1" Text="{Binding TotalTaxes, StringFormat='{0:N0} сум'}" FontSize="20" FontAttributes="Bold" TextColor="#F44336" />
          
          <BoxView Grid.Row="1" Grid.ColumnSpan="2" HeightRequest="1" BackgroundColor="#E0E0E0" Margin="0,12" />
          
          <Label Grid.Row="2" Text="Чистая прибыль" FontSize="16" FontAttributes="Bold" />
          <Label Grid.Row="2" Grid.Column="1" Text="{Binding NetProfit, StringFormat='{0:N0} сум'}" FontSize="20" FontAttributes="Bold" TextColor="#4CAF50" />
        </Grid>
      </Frame>
      
      <Frame Padding="12" CornerRadius="8" BackgroundColor="#E8F5E9">
        <HorizontalStackLayout Spacing="8" HorizontalOptions="Center">
          <Label Text="📊 Рентабельность:" FontSize="14" />
          <Label Text="{Binding NetProfitMargin, StringFormat='{0:F2}%'}" FontSize="18" FontAttributes="Bold" TextColor="#4CAF50" />
        </HorizontalStackLayout>
      </Frame>
      
      <ActivityIndicator IsRunning="{Binding IsBusy}" IsVisible="{Binding IsBusy}" HorizontalOptions="Center" Margin="0,20,0,0" />
      
    </VerticalStackLayout>
  </ScrollView>
  
</ContentPage>
